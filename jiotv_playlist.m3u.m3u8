import requests
import re

# ==========================================
# CONFIGURATION
# ==========================================
template_file = "template.m3u"
youtube_file = "youtube.txt"
reference_file = "jiotv_playlist.m3u.m3u8"
output_file = "playlist.m3u"

# SOURCES
base_url = "http://192.168.0.146:5350/live" 
backup_url = "https://raw.githubusercontent.com/fakeall12398-sketch/JIO_TV/refs/heads/main/jstar.m3u"
fancode_url = "https://raw.githubusercontent.com/Jitendra-unatti/fancode/main/data/fancode.m3u"

# FORCE BACKUP LIST
FORCE_BACKUP_KEYWORDS = [
    "star", "zee", "vijay", "asianet", "suvarna", "maa", "hotstar", "sony", "set", "sab",
    "nick", "cartoon", "pogo", "disney", "hungama", "sonic", "discovery", "nat geo", 
    "history", "tlc", "animal planet", "travelxp", "bbc earth", "movies now", "mnx", "romedy", "mn+", "pix"
]

# 1. MANUAL MAPPING (Fixes Name Differences)
NAME_OVERRIDES = {
    # Infotainment
    "nat geo hd": "national geographic", 
    "nat geo wild hd": "nat geo wild",
    "discovery hd world": "discovery channel", # Added 'channel' to be specific
    "discovery hd english": "discovery channel",
    "animal planet hd world": "animal planet",
    "tlc hd world": "tlc",
    "history tv18 hd": "history",
    "sony bbc earth hd": "bbc earth",
    
    # Sports
    "sony ten 4": "sony sports ten 4",
    "sony ten 4 hd": "sony sports ten 4",
    "sony ten 1": "sony sports ten 1",
    "sony ten 2": "sony sports ten 2",
    "sony ten 3": "sony sports ten 3",
    "sony ten 5": "sony sports ten 5",
    
    # Kids
    "cartoon network hd+ english": "cartoon network",
    "cartoon network tamil": "cartoon network",
    "nick hd+": "nick",
    
    # Movies
    "star movies hd": "star movies",
    "sony pix hd": "sony pix",
    "movies now hd": "movies now",
    "mn+ hd": "mn+",
    "mnx hd": "mnx",
    "romedy now hd": "romedy now",
}

# 2. EXCLUSIONS (The Fix for Nat Geo playing Wild)
# Format: "target_keyword": ["words", "to", "ignore"]
EXCLUSIONS = {
    "nationalgeographic": ["wild"],  # If searching Nat Geo, ignore 'Wild'
    "discovery": ["kids", "science", "turbo", "jeep"], # Ignore Discovery Kids/Science
    "cartoonnetwork": ["hd+"], # Prevent HD+ mismatch if needed
    "sonysportsten1": ["ten2", "ten3", "ten
